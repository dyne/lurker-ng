Quick start
===========

0 Find and install development files for: 

   g++ >= 3.2            - http://gcc.gnu.org/
   jam                   - ftp://ftp.perforce.com/pub/jam
   mimelib  (kdenetwork) - ftp://download.uk.kde.org/pub/kde/stable/latest/src
   xsltproc (libxslt1)   - http://xmlsoft.org/XSLT/
 
 A hint: building jam on Solaris requires that cc -> gcc.
 
 If you need to, lurker can be built using only g++ 2.95, however 3.2 is
 recommended as the resulting binaries are much smaller and faster.
 
 If you do not want kdenetwork, you can also download mimelib separately
 from http://sourceforge.net/project/showfiles.php?group_id=8168 and tell
 lurker to compile it and statically link to it.
 
 xsltproc is not strictly required for lurker. It is not used during compile
 and is only used if your lurker.conf references it. However, it is the
 preferred method for rendering html, so we recommend installing it.
 
 For debian: apt-get install xsltproc libmimelib1-dev jam g++
 
1 [flags] ./configure [options]

  To control the mimelib location, setting these options may help:
  --with-mimelib-local        Use internal lurker/mimelib/*
  --with-mimelib-include=DIR  Location of mimelib/message.h
  --with-mimelib-libname=LIB  Try an alternative library name

  To control the environment, variants of these flags may help:
  LDFLAGS="-L/sw/lib"
  CPPFLAGS="-I/sw/include -DDW_UNIX"
  JAM="/sw/bin/jam"

2 jam

3 jam install	(as root if you don't have permission)
		(DESTDIR=/tmp/lurker jam install -- also works)
  
  You may want to strip the binaries as they can be quite large.

4 Setup delivery of new mail to lurker-index
  
  For procmail, 
	:0 w
	* ^X-Mailing-List: <debian-japanese@lists.debian.org>.*
	| lurker-index -c /etc/lurker.conf -l japanese -m
  ... works for me.

5 Feed archived mail through lurker-index.
  
  lurker-index -c /etc/lurker.conf -l devel -b 5 < debian-devel.mbox
  
  Keep in mind these points:
  
    a. Lurker imports benefit primarily from a fast CPU and fast RAM.
       Lurker rendering of pages benefits from more RAM (for disk cache).
    
    b. The lurker database will consume space on the order of 40% of the
       mailboxes it indexes. You must keep the mbox lurker creates, 
       although the original mbox is not required after lurker-index.
    
    c. Nearly all of the processing time lurker spends is on importing
       messages. Once you have indexed your archive, lurker no longer needs
       as much resources.
    
6 Setup a cronjob to update the archive every 15 minutes
  
  0,15,30,45 * * * * lurker-prune -c /etc/lurker.conf -d /path/to/www/lurker
  
  This must be run with the ability to read and delete files from the
  web-server cache directory.
  
7 Configure your webserver.
  
  You must make certain that .xsl and .xml files have type text/xml.
  You must set the default charset to utf-8 for these files.
  You must make lurker your 404 error handler.
  You must pass the config file and lurker's document root to lurker.cgi 
      as ? delimited arguments in QUERY_STRING 'cfgfile?docdir'. The docdir
      is relative to the location of lurker.cgi and cfgfile is relative to
      the docdir.
  
  If you run apache with a directory structure like:

	www/
		lurker.conf
		cgi-bin/
			lurker.cgi
			keyword.cgi
			jump.cgi
		htdocs/
			.htaccess
			index.html
			browserdetect.js
			splash/
			search/
			mindex/
			...

   then .htaccess should contain:

	AddType text/xml .xsl
	AddType text/xml .xml
	AddDefaultCharset UTF-8
	ErrorDocument 404 /cgi-bin/lurker.cgi?../lurker.conf?../htdocs


8 point your browser at the url where lurker is installed

	http://yourhost.com/~youruser/	for the first example configure
	http://yourhost.com/lurker/	for the second example configure

Enjoy!
